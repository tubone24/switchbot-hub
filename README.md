# SwitchBot & Netatmo & Google Nest Hub Monitor

SwitchBotãƒ‡ãƒã‚¤ã‚¹ã€Netatmo Weather Stationã€Google Nestï¼ˆãƒ‰ã‚¢ãƒ™ãƒ«/ã‚«ãƒ¡ãƒ©ï¼‰ã®çŠ¶æ…‹ã‚’ç›£è¦–ã—ã€å¤‰åŒ–ãŒã‚ã‚Œã°Slackã«é€šçŸ¥ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

<img width="652" height="582" alt="ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 2026-01-30 11 09 42" src="https://github.com/user-attachments/assets/e5ddebe0-bcdb-4fd1-bc40-e2021252cba1" />


## ç‰¹å¾´

- **ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç›£è¦–**: SwitchBotã€Netatmoã€Google Nestã‚’ä¸€å…ƒç®¡ç†
- **ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ç›£è¦–**: ãƒãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ã¨Webhookæ–¹å¼ã‚’çµ„ã¿åˆã‚ã›
- **è¤‡æ•°Slackãƒãƒ£ãƒ³ãƒãƒ«å¯¾å¿œ**: é˜²çŠ¯/ç’°å¢ƒæ›´æ–°/ã‚°ãƒ©ãƒ•ã‚’åˆ¥ãƒãƒ£ãƒ³ãƒãƒ«ã«é€šçŸ¥
- **æ—¥æœ¬èªé€šçŸ¥**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã¯ã€Œè§£éŒ ã•ã‚Œã¾ã—ãŸã€ãªã©ã‚ã‹ã‚Šã‚„ã™ãé€šçŸ¥
- **5åˆ†ã”ã¨ã®ã‚°ãƒ©ãƒ•ãƒ¬ãƒãƒ¼ãƒˆ**: æ¸©æ¹¿åº¦ãƒ»CO2ãƒ»æ°—åœ§ãƒ»é¨’éŸ³ã‚’å±‹å¤–/å±‹å†…ã§åˆ†ã‘ã¦ã‚°ãƒ©ãƒ•åŒ–
- **ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆ**: Raspberry Piå‘ã‘ã«matplotlibã§ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆï¼‹Slackãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯¾å¿œ
- **Quick Tunnelå¯¾å¿œ**: ãƒ‰ãƒ¡ã‚¤ãƒ³ä¸è¦ã§Webhookå—ä¿¡å¯èƒ½ï¼ˆURLã¯è‡ªå‹•æ›´æ–°ï¼‰
- **JSTè¡¨ç¤º**: ã‚°ãƒ©ãƒ•ã®æ™‚é–“è»¸ã¯æ—¥æœ¬æ™‚é–“
- **ã‚´ãƒŸåé›†é€šçŸ¥**: æ›œæ—¥ã”ã¨ã®ã‚´ãƒŸå‡ºã—ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’ç”»åƒä»˜ãã§é€šçŸ¥
- **Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: LANã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆ30ç§’è‡ªå‹•æ›´æ–°ï¼‰

## å¯¾å¿œãƒ‡ãƒã‚¤ã‚¹

### SwitchBot
- æ¸©æ¹¿åº¦è¨ˆï¼ˆMeter, MeterPlus, MeterProï¼‰
- CO2ã‚»ãƒ³ã‚µãƒ¼ï¼ˆMeterPro CO2ï¼‰
- é˜²æ°´æ¸©æ¹¿åº¦è¨ˆï¼ˆOutdoor Meterï¼‰
- Hub 2
- ã‚¹ãƒãƒ¼ãƒˆãƒ­ãƒƒã‚¯
- é–‹é–‰ã‚»ãƒ³ã‚µãƒ¼
- ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒ³ã‚µãƒ¼
- ãƒ‰ã‚¢ãƒ™ãƒ«

### Netatmo Weather Station
- ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ / NAMainï¼ˆæ¸©åº¦ãƒ»æ¹¿åº¦ãƒ»CO2ãƒ»æ°—åœ§ãƒ»é¨’éŸ³ï¼‰
- å±‹å¤–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« / NAModule1ï¼ˆæ¸©åº¦ãƒ»æ¹¿åº¦ï¼‰
- è¿½åŠ å®¤å†…ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« / NAModule4ï¼ˆæ¸©åº¦ãƒ»æ¹¿åº¦ãƒ»CO2ï¼‰
- é¢¨ã‚»ãƒ³ã‚µãƒ¼ / NAModule2ï¼ˆé¢¨é€Ÿãƒ»é¢¨å‘ãƒ»çªé¢¨é€Ÿãƒ»çªé¢¨å‘ï¼‰
- é›¨ã‚»ãƒ³ã‚µãƒ¼ / NAModule3ï¼ˆé›¨é‡ãƒ»1æ™‚é–“ç´¯è¨ˆãƒ»24æ™‚é–“ç´¯è¨ˆï¼‰

### Google Nestï¼ˆDevice Access APIï¼‰
- Nest Doorbellï¼ˆãƒ‰ã‚¢ãƒ™ãƒ«ãƒãƒ£ã‚¤ãƒ ãƒ»äººç‰©æ¤œçŸ¥ãƒ»å‹•ä½“æ¤œçŸ¥ï¼‰
- Nest Cameraï¼ˆäººç‰©æ¤œçŸ¥ãƒ»å‹•ä½“æ¤œçŸ¥ãƒ»éŸ³å£°æ¤œçŸ¥ï¼‰
- ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾å¿œï¼ˆNest Awareå¥‘ç´„æ™‚ï¼‰

## Slacké€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ«

| ãƒãƒ£ãƒ³ãƒãƒ« | ç”¨é€” | é€šçŸ¥ä¾‹ |
|-----------|------|--------|
| `#home-security` | é˜²çŠ¯ãƒ‡ãƒã‚¤ã‚¹ï¼ˆãƒ­ãƒƒã‚¯ã€é–‹é–‰ã‚»ãƒ³ã‚µãƒ¼ã€Nestç­‰ï¼‰ | ğŸ”“ ãƒ­ãƒƒã‚¯Pro 24ãŒè§£éŒ ã•ã‚Œã¾ã—ãŸ / ğŸ”” ç„é–¢ãŒæŠ¼ã•ã‚Œã¾ã—ãŸ |
| `#atmos-update` | æ¸©æ¹¿åº¦ãƒ»CO2ã®å¤‰åŒ–ï¼ˆWebhookï¼‰ | CO2ã‚»ãƒ³ã‚µãƒ¼ 3A: 22.7Â°C / 51% / 1013ppm |
| `#atmos-graph` | 5åˆ†ã”ã¨ã®ã‚°ãƒ©ãƒ•ãƒ¬ãƒãƒ¼ãƒˆ | å±‹å¤–/å±‹å†…ã®æ¸©åº¦ãƒ»æ¹¿åº¦ãƒ»CO2ã‚°ãƒ©ãƒ• |
| `#outdoor-alert` | ãŠå¤–ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆNetatmoå°‚ç”¨ï¼‰ | â˜” é›¨ãŒé™ã‚Šå§‹ã‚ã¾ã—ãŸ |
| `#general` | ã‚´ãƒŸåé›†ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ | æ˜æ—¥ã¯ã€Œç‡ƒã‚„ã™ã”ã¿ã€ã®æ—¥ã§ã™ï¼ˆç”»åƒä»˜ãï¼‰ |

## å¿…è¦è¦ä»¶

- Python 3.7ä»¥ä¸Š
- requests ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- SwitchBot Hub (Hub Mini, Hub 2ãªã©)
- cloudflared (Webhookä½¿ç”¨æ™‚)
- Netatmo Weather Stationï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- Google Nest Doorbell/Cameraï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  - Device Access ç™»éŒ²ï¼ˆ$5 ä¸€å›æ‰•ã„ï¼‰
  - Google Cloud ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
- matplotlib 3.5.3ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆæ™‚ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. SwitchBot APIèªè¨¼æƒ…å ±ã®å–å¾—

1. SwitchBotã‚¢ãƒ—ãƒªã‚’é–‹ã (v6.14ä»¥ä¸Š)
2. **ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«** > **è¨­å®š** > **ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³** ã‚’10å›ã‚¿ãƒƒãƒ—
3. **é–‹ç™ºè€…ã‚ªãƒ—ã‚·ãƒ§ãƒ³** ãŒè¡¨ç¤ºã•ã‚Œã‚‹
4. **ãƒˆãƒ¼ã‚¯ãƒ³** ã¨ **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼** ã‚’å–å¾—

### 2. Netatmo APIèªè¨¼æƒ…å ±ã®å–å¾—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

#### ã‚¹ãƒ†ãƒƒãƒ—1: Netatmoã‚¢ãƒ—ãƒªã®ä½œæˆ

1. [Netatmo Connect](https://dev.netatmo.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **Create an App** ã§ã‚¢ãƒ—ãƒªã‚’ä½œæˆ
   - App Name: ä»»æ„ã®åå‰ï¼ˆä¾‹: `Home Monitor`ï¼‰
   - Description: ä»»æ„ã®èª¬æ˜
   - Data Protection Officer: è‡ªåˆ†ã®åå‰ã¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
3. **Client ID** ã¨ **Client Secret** ã‚’ãƒ¡ãƒ¢

#### ã‚¹ãƒ†ãƒƒãƒ—2: èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼ã§ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—

```bash
# èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’å®Ÿè¡Œ
python netatmo_auth.py
```

å¯¾è©±å½¢å¼ã§æ¡ˆå†…ã•ã‚Œã¾ã™:
1. Client ID ã‚’å…¥åŠ›
2. Client Secret ã‚’å…¥åŠ›
3. ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§é–‹ã â†’ Netatmoã«ãƒ­ã‚°ã‚¤ãƒ³ â†’ è¨±å¯
4. ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹

```
$ python netatmo_auth.py
============================================================
Netatmo OAuth2 èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼
============================================================

Client ID ã‚’å…¥åŠ›: xxxxxxxxxxxxxxxxxxxxxxxx
Client Secret ã‚’å…¥åŠ›: xxxxxxxxxxxxxxxxxxxxxxxx

ãƒ–ãƒ©ã‚¦ã‚¶ã§ä»¥ä¸‹ã®URLã‚’é–‹ãã¾ã™...

èªå¯ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã—ãŸ!

ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—æˆåŠŸ!

Refresh Token: xxxxxxxxxxxxxxxxxxxxxxxx

============================================================
config.json ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¦ãã ã•ã„:
============================================================
{
    "netatmo": {
        "enabled": true,
        "client_id": "xxxxxxxx",
        "client_secret": "xxxxxxxx",
        "refresh_token": "xxxxxxxx",
        ...
    }
}
```

> **Note**: èªè¨¼æƒ…å ±ã¯ `netatmo_credentials.json` ã«ä¿å­˜ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§é¸æŠå¯èƒ½ï¼‰

### 3. Google Nest APIèªè¨¼æƒ…å ±ã®å–å¾—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

Google Nest Doorbell/Cameraã‚’ç›£è¦–ã™ã‚‹å ´åˆã«å¿…è¦ã§ã™ã€‚

#### ã‚¹ãƒ†ãƒƒãƒ—1: Device Access ã«ç™»éŒ²

1. [Device Access Console](https://console.nest.google.com/device-access/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **$5** ã®ä¸€å›æ‰•ã„ã§é–‹ç™ºè€…ç™»éŒ²
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€**Project ID (UUID)** ã‚’ãƒ¡ãƒ¢

#### ã‚¹ãƒ†ãƒƒãƒ—2: Google Cloud ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š

1. [Google Cloud Console](https://console.cloud.google.com/) ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
2. **Smart Device Management API** ã‚’æœ‰åŠ¹åŒ–
3. **OAuth 2.0 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ID** ã‚’ä½œæˆï¼ˆWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
4. **Authorized redirect URIs** ã« `http://localhost:8888` ã‚’è¿½åŠ 
5. **Client ID** ã¨ **Client Secret** ã‚’ãƒ¡ãƒ¢

#### ã‚¹ãƒ†ãƒƒãƒ—3: Pub/Sub ã®è¨­å®šï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆç”¨ï¼‰

1. [Cloud Pub/Sub](https://console.cloud.google.com/cloudpubsub) ã§ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆ
   - ãƒˆãƒ”ãƒƒã‚¯å: `projects/sdm-prod/topics/enterprise-YOUR_PROJECT_ID`
2. ãã®ãƒˆãƒ”ãƒƒã‚¯ã«**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³**ã‚’ä½œæˆ
3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã« `pubsub.subscriber` æ¨©é™ã‚’ä»˜ä¸

#### ã‚¹ãƒ†ãƒƒãƒ—4: èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼ã§ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—

```bash
python google_nest_auth.py
```

å¯¾è©±å½¢å¼ã§æ¡ˆå†…ã•ã‚Œã¾ã™:
1. Device Access Project ID ã‚’å…¥åŠ›
2. OAuth2 Client ID ã‚’å…¥åŠ›
3. OAuth2 Client Secret ã‚’å…¥åŠ›
4. ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ã â†’ Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ â†’ Nestãƒ‡ãƒã‚¤ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯
5. ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹

```
$ python google_nest_auth.py
============================================================
Google Nest Device Access - OAuth2 Setup Helper
============================================================

Device Access Project ID (UUID): xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
OAuth2 Client ID: xxxxxxx.apps.googleusercontent.com
OAuth2 Client Secret: xxxxxxxxxxxxxxxx

ãƒ–ãƒ©ã‚¦ã‚¶ã§èªè¨¼ãƒšãƒ¼ã‚¸ã‚’é–‹ãã¾ã™...

æˆåŠŸ! ä»¥ä¸‹ã®è¨­å®šã‚’ config.json ã«è¿½åŠ ã—ã¦ãã ã•ã„:
{
    "google_nest": {
        "enabled": true,
        "project_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "client_id": "xxxxxxx.apps.googleusercontent.com",
        "client_secret": "xxxxxxxx",
        "refresh_token": "xxxxxxxx",
        ...
    }
}
```

### 4. Slack Incoming Webhookã®è¨­å®š

è¤‡æ•°ã®ãƒãƒ£ãƒ³ãƒãƒ«ç”¨ã«Webhook URLã‚’å–å¾—:

1. [Slack API](https://api.slack.com/apps) ã§ã‚¢ãƒ—ãƒªã‚’ä½œæˆ
2. **Incoming Webhooks** ã‚’æœ‰åŠ¹åŒ–
3. ä»¥ä¸‹ã®ãƒãƒ£ãƒ³ãƒãƒ«ãã‚Œãã‚Œã«Webhook URLã‚’ä½œæˆ:
   - `#home-security` (é˜²çŠ¯é€šçŸ¥)
   - `#atmos-update` (ç’°å¢ƒå¤‰åŒ–é€šçŸ¥)
   - `#atmos-graph` (ã‚°ãƒ©ãƒ•ãƒ¬ãƒãƒ¼ãƒˆ)

### 4. cloudflaredã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆRaspberry Piï¼‰

```bash
# ARMç‰ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
wget https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm
sudo mv cloudflared-linux-arm /usr/local/bin/cloudflared
sudo chmod +x /usr/local/bin/cloudflared

# ç¢ºèª
cloudflared --version
```

### 5. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

```bash
cp config.json.example config.json
```

`config.json` ã‚’ç·¨é›†:

```json
{
    "switchbot": {
        "token": "YOUR_SWITCHBOT_API_TOKEN",
        "secret": "YOUR_SWITCHBOT_API_SECRET"
    },
    "netatmo": {
        "enabled": true,
        "client_id": "YOUR_NETATMO_CLIENT_ID",
        "client_secret": "YOUR_NETATMO_CLIENT_SECRET",
        "refresh_token": "YOUR_NETATMO_REFRESH_TOKEN",
        "credentials_file": null,
        "interval_seconds": 600
    },
    "google_nest": {
        "enabled": true,
        "project_id": "YOUR_DEVICE_ACCESS_PROJECT_ID",
        "client_id": "YOUR_OAUTH_CLIENT_ID.apps.googleusercontent.com",
        "client_secret": "YOUR_OAUTH_CLIENT_SECRET",
        "refresh_token": "YOUR_REFRESH_TOKEN",
        "credentials_file": null,
        "interval_seconds": 300,
        "pubsub": {
            "enabled": true,
            "gcp_project_id": "YOUR_GCP_PROJECT_ID",
            "subscription_id": "YOUR_PUBSUB_SUBSCRIPTION_ID",
            "poll_timeout_seconds": 60
        }
    },
    "slack": {
        "channels": {
            "home_security": "https://hooks.slack.com/services/YOUR/SECURITY/WEBHOOK",
            "atmos_update": "https://hooks.slack.com/services/YOUR/ATMOS/WEBHOOK",
            "atmos_graph": "https://hooks.slack.com/services/YOUR/GRAPH/WEBHOOK"
        },
        "enabled": true,
        "notify_startup": true,
        "notify_errors": true
    },
    "monitor": {
        "interval_seconds": 1800,
        "ignore_devices": ["ãƒ†ãƒ¼ãƒ—ãƒ©ã‚¤ãƒˆ BA", "ãƒãƒ–ãƒŸãƒ‹ DC"],
        "polling_devices": ["CO2ã‚»ãƒ³ã‚µãƒ¼", "æ¸©æ¹¿åº¦è¨ˆ", "ãƒãƒ–ï¼’"]
    },
    "webhook": {
        "enabled": true,
        "port": 8080,
        "path": "/switchbot/webhook"
    },
    "cloudflare_tunnel": {
        "enabled": true,
        "hostname": null,
        "config_path": null
    },
    "database": {
        "path": "device_states.db",
        "history_days": 30,
        "sensor_data_days": 7,
        "netatmo_data_days": 7
    },
    "graph_report": {
        "enabled": true,
        "interval_minutes": 5
    },
    "dashboard": {
        "enabled": true,
        "port": 7777
    },
    "logging": {
        "level": "INFO",
        "file": null
    }
}
```

### 6. å®Ÿè¡Œ

```bash
pip install requests
python main.py
```

## è¨­å®šé …ç›®

### switchbot

| é …ç›® | èª¬æ˜ |
|------|------|
| `token` | SwitchBot APIãƒˆãƒ¼ã‚¯ãƒ³ |
| `secret` | SwitchBot APIã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ |

### netatmo

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | Netatmoç›£è¦–ã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `client_id` | Netatmoã‚¢ãƒ—ãƒªã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆid |
| `client_secret` | Netatmoã‚¢ãƒ—ãƒªã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ |
| `refresh_token` | OAuth2ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ |
| `credentials_file` | ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³æ°¸ç¶šåŒ–ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |
| `interval_seconds` | ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ï¼ˆç§’ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ600ç§’ï¼ˆ10åˆ†ï¼‰ |

**credentials_file ã«ã¤ã„ã¦:**

Netatmoã¯ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ãŒå®šæœŸçš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚`credentials_file` ã‚’æŒ‡å®šã™ã‚‹ã¨ã€æ›´æ–°ã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’è‡ªå‹•ã§ä¿å­˜ã—ã¾ã™ã€‚æŒ‡å®šã—ãªã„å ´åˆã€é•·æœŸé–“å®Ÿè¡Œã—ã¦ã„ã‚‹ã¨èªè¨¼ãŒåˆ‡ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### google_nest

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | Google Nestç›£è¦–ã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `project_id` | Device Access ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID (UUIDå½¢å¼) |
| `client_id` | Google Cloud OAuth2 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID |
| `client_secret` | Google Cloud OAuth2 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ |
| `refresh_token` | OAuth2ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ |
| `credentials_file` | ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³æ°¸ç¶šåŒ–ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |
| `interval_seconds` | ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ï¼ˆç§’ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ300ç§’ï¼ˆ5åˆ†ï¼‰ |

#### google_nest.pubsubï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆç”¨ï¼‰

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | Pub/Sub ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `gcp_project_id` | Google Cloud ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID |
| `subscription_id` | Pub/Sub ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ID |
| `poll_timeout_seconds` | Long polling ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç§’ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ60ç§’ |

**ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—:**

| ã‚¤ãƒ™ãƒ³ãƒˆ | èª¬æ˜ | å¯¾å¿œãƒ‡ãƒã‚¤ã‚¹ |
|---------|------|-------------|
| `chime` | ãƒ‰ã‚¢ãƒ™ãƒ«ãŒæŠ¼ã•ã‚ŒãŸ | Nest Doorbell |
| `motion` | å‹•ãã‚’æ¤œçŸ¥ | Doorbell / Camera |
| `person` | äººç‰©ã‚’æ¤œçŸ¥ | Doorbell / Camera |
| `sound` | éŸ³å£°ã‚’æ¤œçŸ¥ | Camera |
| `clip_preview` | ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ | Doorbell / Cameraï¼ˆNest Awareå¥‘ç´„æ™‚ï¼‰ |

**ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã¤ã„ã¦:**

Nest Awareå¥‘ç´„ãŒã‚ã‚‹å ´åˆã€ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆçŸ­ã„å‹•ç”»ï¼‰ã®URLãŒå–å¾—ã§ãã¾ã™ã€‚æœ¬ãƒ„ãƒ¼ãƒ«ã¯ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è‡ªå‹•ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€Slacké€šçŸ¥ã«æ·»ä»˜ã—ã¾ã™ã€‚

### slack

| é …ç›® | èª¬æ˜ |
|------|------|
| `bot_token` | Bot User OAuth Tokenï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒˆä½¿ç”¨æ™‚ã«å¿…è¦ã€`xoxb-...`å½¢å¼ï¼‰ |
| `channels.home_security` | é˜²çŠ¯é€šçŸ¥ç”¨Webhook URL |
| `channels.atmos_update` | ç’°å¢ƒå¤‰åŒ–é€šçŸ¥ç”¨Webhook URL |
| `channels.atmos_graph` | ã‚°ãƒ©ãƒ•ãƒ¬ãƒãƒ¼ãƒˆç”¨Webhook URLã¾ãŸã¯Channel IDï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒˆæ™‚ã¯`C...`å½¢å¼ã®IDï¼‰ |
| `enabled` | Slacké€šçŸ¥ã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `notify_startup` | èµ·å‹•æ™‚ã«é€šçŸ¥ |
| `notify_errors` | ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«é€šçŸ¥ |

### monitor

| é …ç›® | èª¬æ˜ |
|------|------|
| `interval_seconds` | SwitchBotãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ï¼ˆç§’ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ1800ç§’ï¼ˆ30åˆ†ï¼‰ |
| `ignore_devices` | ç›£è¦–ã—ãªã„ãƒ‡ãƒã‚¤ã‚¹åã®ãƒªã‚¹ãƒˆï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰ |
| `polling_devices` | ãƒãƒ¼ãƒªãƒ³ã‚°ã§ç›£è¦–ã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹åã®ãƒªã‚¹ãƒˆï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰ |

**ãƒ‡ãƒã‚¤ã‚¹ã®æŒ¯ã‚Šåˆ†ã‘ãƒ­ã‚¸ãƒƒã‚¯:**
1. `ignore_devices` ã«ä¸€è‡´ â†’ ç„¡è¦–
2. `polling_devices` ã«ä¸€è‡´ â†’ ãƒãƒ¼ãƒªãƒ³ã‚°ç›£è¦–ï¼ˆã‚°ãƒ©ãƒ•ç”¨ãƒ‡ãƒ¼ã‚¿è“„ç©ï¼‰
3. ã©ã¡ã‚‰ã«ã‚‚ä¸€è‡´ã—ãªã„ â†’ Webhookç›£è¦–

### webhook

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | Webhookã‚µãƒ¼ãƒãƒ¼ã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `port` | ãƒªãƒƒã‚¹ãƒ³ãƒãƒ¼ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ8080ï¼‰ |
| `path` | Webhookã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ‘ã‚¹ |

### cloudflare_tunnel

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | Cloudflare Tunnelã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `hostname` | ãƒˆãƒ³ãƒãƒ«ã®ãƒ›ã‚¹ãƒˆåï¼ˆ`null`ã§Quick Tunnelï¼‰ |
| `config_path` | cloudflaredè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆ`null`ã§Quick Tunnelï¼‰ |

**Quick Tunnel ãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰:**

`hostname` ã¨ `config_path` ã®ä¸¡æ–¹ã‚’ `null` ã«ã™ã‚‹ã¨ã€Cloudflare Quick Tunnelã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- ãƒ‰ãƒ¡ã‚¤ãƒ³ä¸è¦ã€èªè¨¼ä¸è¦ã§å³åº§ã«ä½¿ãˆã‚‹
- èµ·å‹•ã”ã¨ã«ãƒ©ãƒ³ãƒ€ãƒ ãªURLï¼ˆ`xxx.trycloudflare.com`ï¼‰ãŒç”Ÿæˆã•ã‚Œã‚‹
- **è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**: èµ·å‹•æ™‚ã«å¤ã„Webhook URLã‚’SwitchBotã‹ã‚‰è‡ªå‹•å‰Šé™¤ã—ã€æ–°ã—ã„URLã‚’ç™»éŒ²

### database

| é …ç›® | èª¬æ˜ |
|------|------|
| `path` | SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ |
| `history_days` | çŠ¶æ…‹å¤‰æ›´å±¥æ­´ã®ä¿æŒæ—¥æ•° |
| `sensor_data_days` | SwitchBotã‚»ãƒ³ã‚µãƒ¼æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®ä¿æŒæ—¥æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ7æ—¥ï¼‰ |
| `netatmo_data_days` | Netatmoæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®ä¿æŒæ—¥æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ7æ—¥ï¼‰ |

### graph_report

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | ã‚°ãƒ©ãƒ•ãƒ¬ãƒãƒ¼ãƒˆã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `interval_minutes` | ãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡é–“éš”ï¼ˆåˆ†ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5åˆ† |
| `downsample_seconds` | ãƒ‡ãƒ¼ã‚¿ã®ãƒ€ã‚¦ãƒ³ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°é–“éš”ï¼ˆç§’ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ600ç§’ |
| `use_local_chart` | ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆã‚’ä½¿ç”¨ï¼ˆRaspberry Piå‘ã‘ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ`false` |

#### ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆï¼ˆRaspberry Piå‘ã‘ï¼‰

`use_local_chart: true` ã«ã™ã‚‹ã¨ã€QuickChart.io URLã®ä»£ã‚ã‚Šã«matplotlibã§ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆã—ã€Slackãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§é€ä¿¡ã—ã¾ã™ã€‚

**åˆ©ç‚¹:**
- QuickChart.ioã¸ã®å¤–éƒ¨ä¾å­˜ãªã—
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸å®‰å®šæ™‚ã§ã‚‚ç¢ºå®Ÿã«ã‚°ãƒ©ãƒ•ç”Ÿæˆ
- é«˜è§£åƒåº¦ã®ç”»åƒ

**å¿…è¦ãªè¨­å®š:**

```json
{
  "slack": {
    "bot_token": "xoxb-your-bot-token",
    "channels": {
      "atmos_graph": "C0123456789"
    }
  },
  "graph_report": {
    "use_local_chart": true
  }
}
```

**å¿…è¦ãªBot Tokenã‚¹ã‚³ãƒ¼ãƒ—:**
- `files:write` - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”¨
- `chat:write` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ç”¨

**Raspberry Piã§ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—:**

```bash
# æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt-get install fonts-ipaexfont fonts-ipafont

# Python ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆPython 3.7å¯¾å¿œç‰ˆï¼‰
pip install matplotlib==3.5.3
```

### dashboard

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `port` | HTTPã‚µãƒ¼ãƒãƒ¼ã®ãƒãƒ¼ãƒˆç•ªå·ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ7777ï¼‰ |

**è¨­å®šä¾‹:**

```json
{
    "dashboard": {
        "enabled": true,
        "port": 7777
    }
}
```

**ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•:**

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://<Raspberry Piã®IP>:7777/` ã«ã‚¢ã‚¯ã‚»ã‚¹

**æ©Ÿèƒ½:**
- å…¨ã‚»ãƒ³ã‚µãƒ¼ã®ç¾åœ¨å€¤ã‚’ã‚«ãƒ¼ãƒ‰å½¢å¼ã§è¡¨ç¤º
- 24æ™‚é–“åˆ†ã®æ™‚ç³»åˆ—ã‚°ãƒ©ãƒ•ï¼ˆæ¸©åº¦ãƒ»æ¹¿åº¦ãƒ»CO2ãƒ»æ°—åœ§ãƒ»é¨’éŸ³ãƒ»é¢¨é€Ÿãƒ»é›¨é‡ï¼‰
- 30ç§’ã”ã¨ã«è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
- ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–UI
- ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œ

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:**

| ãƒ‘ã‚¹ | èª¬æ˜ |
|------|------|
| `/` | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰HTML |
| `/api/data` | ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿JSON API |
| `/health` | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ |

### logging

| é …ç›® | èª¬æ˜ |
|------|------|
| `level` | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« (DEBUG, INFO, WARNING, ERROR) |
| `file` | ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆ`null`ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã¿ï¼‰ |

### garbage_collection

| é …ç›® | èª¬æ˜ |
|------|------|
| `enabled` | ã‚´ãƒŸåé›†é€šçŸ¥ã®æœ‰åŠ¹/ç„¡åŠ¹ |
| `channel_id` | é€šçŸ¥å…ˆSlackãƒãƒ£ãƒ³ãƒãƒ«IDï¼ˆ`C...`å½¢å¼ï¼‰ |
| `image_dir` | ã‚´ãƒŸç¨®é¡ã”ã¨ã®ç”»åƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª |
| `evening_hour` | å‰æ—¥é€šçŸ¥ã®æ™‚åˆ»ï¼ˆ0-23ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ20 |
| `morning_hour` | å½“æ—¥é€šçŸ¥ã®æ™‚åˆ»ï¼ˆ0-23ï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ6 |
| `schedule` | æ›œæ—¥ã”ã¨ã®ã‚´ãƒŸç¨®é¡ï¼ˆmondayã€œsundayï¼‰ |
| `monthly_schedule` | æœˆæ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆç¬¬né€±ã®æ›œæ—¥æŒ‡å®šï¼‰ |
| `additional_rules` | ãƒ¡ã‚¤ãƒ³ç¨®é¡ã«ç´ã¥ãè¿½åŠ åé›†ã‚¢ã‚¤ãƒ†ãƒ  |

**é€šçŸ¥ã‚¿ã‚¤ãƒŸãƒ³ã‚°:**
- **evening_houræ™‚**: ç¿Œæ—¥ã®ã‚´ãƒŸåé›†ã‚’é€šçŸ¥ï¼ˆã€Œæ˜æ—¥ã¯ã€‡ã€‡ã®æ—¥ã§ã™ã€ï¼‰
- **morning_houræ™‚**: å½“æ—¥ã®ã‚´ãƒŸåé›†ã‚’é€šçŸ¥ï¼ˆã€Œä»Šæ—¥ã¯ã€‡ã€‡ã®æ—¥ã§ã™ã€ï¼‰

**æœˆæ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è¨­å®šä¾‹:**

å¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«ã®ã‚ˆã†ã«ã€Œç¬¬2ãƒ»ç¬¬4æ—¥æ›œæ—¥ã€ãªã©éš”é€±ã‚„æœˆ1å›ã®åé›†ã«å¯¾å¿œï¼š

```json
"monthly_schedule": {
    "å¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«": {
        "weekday": "sunday",
        "weeks": [2, 4]
    },
    "ç²—å¤§ã”ã¿": {
        "weekday": "saturday",
        "weeks": [1]
    }
}
```

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | èª¬æ˜ |
|-----------|------|
| `weekday` | æ›œæ—¥ï¼ˆmondayã€œsundayï¼‰ |
| `weeks` | æœˆã®ç¬¬né€±ã®ãƒªã‚¹ãƒˆï¼ˆ1ã€œ5ï¼‰ |

ä¸Šè¨˜ã®è¨­å®šã§ã€ç¬¬2æ—¥æ›œæ—¥ã®é€šçŸ¥ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```
æ˜æ—¥ã¯ã€Œå¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«ã€ã®æ—¥ã§ã™
```

é€±æ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆ`schedule`ï¼‰ã¨æœˆæ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆ`monthly_schedule`ï¼‰ãŒåŒã˜æ—¥ã«é‡ãªã£ãŸå ´åˆã€ä¸¡æ–¹ãŒé€šçŸ¥ã•ã‚Œã¾ã™ï¼š
```
æ˜æ—¥ã¯ã€Œç‡ƒã‚„ã™ã”ã¿ã€ã€ã€Œå¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«ã€ã®æ—¥ã§ã™
ï¼ˆç‡ƒãˆãªã„ã”ã¿ã€ã‚¹ãƒ—ãƒ¬ãƒ¼ç¼¶ã€é›»æ± é¡ã‚‚åé›†æ—¥ã§ã™ï¼‰
```

**è¿½åŠ åé›†ãƒ«ãƒ¼ãƒ«ã®è¨­å®šä¾‹:**

```json
"additional_rules": {
    "ç‡ƒã‚„ã™ã”ã¿": ["ç‡ƒãˆãªã„ã”ã¿", "ã‚¹ãƒ—ãƒ¬ãƒ¼ç¼¶", "é›»æ± é¡"],
    "ç¼¶ãƒ»ã³ã‚“ãƒ»ãƒšãƒƒãƒˆãƒœãƒˆãƒ«": ["å°ã•ãªé‡‘å±é¡"]
}
```

**ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™:**

`garbage_images/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¾ã™ã€‚

ç”»åƒã®æ¤œç´¢å„ªå…ˆé †ä½ï¼š
1. **ã‚´ãƒŸç¨®é¡å**ï¼ˆä¾‹ï¼š`å¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«.png`ï¼‰
2. **æ›œæ—¥å**ï¼ˆä¾‹ï¼š`æœˆ.png`ï¼‰

```
garbage_images/
â”œâ”€â”€ æœˆ.png           # æ›œæ—¥ãƒ™ãƒ¼ã‚¹ï¼ˆç‡ƒã‚„ã™ã”ã¿ï¼‰
â”œâ”€â”€ ç«.png           # æ›œæ—¥ãƒ™ãƒ¼ã‚¹ï¼ˆãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯è³‡æºï¼‰
â”œâ”€â”€ æœ¨.png           # æ›œæ—¥ãƒ™ãƒ¼ã‚¹ï¼ˆç¼¶ãƒ»ã³ã‚“ãƒ»ãƒšãƒƒãƒˆãƒœãƒˆãƒ«ï¼‰
â”œâ”€â”€ é‡‘.png           # æ›œæ—¥ãƒ™ãƒ¼ã‚¹ï¼ˆç‡ƒã‚„ã™ã”ã¿ï¼‰
â”œâ”€â”€ å¤ç´™ãƒ»æ®µãƒœãƒ¼ãƒ«.png  # ç¨®é¡åãƒ™ãƒ¼ã‚¹ï¼ˆæœˆæ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”¨ï¼‰
â””â”€â”€ ç²—å¤§ã”ã¿.png      # ç¨®é¡åãƒ™ãƒ¼ã‚¹ï¼ˆæœˆæ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”¨ï¼‰
```

**æ³¨**:
- åé›†ãŒãªã„æ—¥ã¯é€šçŸ¥ãŒã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ãŸã‚ã€ç”»åƒã¯ä¸è¦ã§ã™
- æœˆæ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚´ãƒŸç¨®é¡ã¯ç¨®é¡åã§ã®ç”»åƒã‚’æ¨å¥¨ï¼ˆæ›œæ—¥ãŒä¸å®šã®ãŸã‚ï¼‰

## ã‚°ãƒ©ãƒ•ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½

5åˆ†ã”ã¨ã« `#atmos-graph` ãƒãƒ£ãƒ³ãƒãƒ«ã¸ã‚°ãƒ©ãƒ•ä»˜ããƒ¬ãƒãƒ¼ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚

### ç”Ÿæˆã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•ï¼ˆæœ€å¤§11ç¨®é¡ï¼‰

| ã‚°ãƒ©ãƒ• | å†…å®¹ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ |
|-------|------|-------------|
| ğŸŒ³ å±‹å¤– æ¸©åº¦ | å±‹å¤–ã‚»ãƒ³ã‚µãƒ¼ã®æ¸©åº¦æ¨ç§» | SwitchBot + Netatmo |
| ğŸŒ³ å±‹å¤– æ¹¿åº¦ | å±‹å¤–ã‚»ãƒ³ã‚µãƒ¼ã®æ¹¿åº¦æ¨ç§» | SwitchBot + Netatmo |
| ğŸ  å±‹å†… æ¸©åº¦ | å®¤å†…ã‚»ãƒ³ã‚µãƒ¼ã®æ¸©åº¦æ¨ç§» | SwitchBot + Netatmo |
| ğŸ  å±‹å†… æ¹¿åº¦ | å®¤å†…ã‚»ãƒ³ã‚µãƒ¼ã®æ¹¿åº¦æ¨ç§» | SwitchBot + Netatmo |
| ğŸ  CO2æ¿ƒåº¦ | å®¤å†…ã®CO2æ¨ç§»ï¼ˆ1000ppm/1500ppmã—ãã„å€¤ãƒ©ã‚¤ãƒ³ä»˜ãï¼‰ | SwitchBot + Netatmo |
| ğŸ  æ°—åœ§ | æ°—åœ§æ¨ç§» | Netatmo (NAMain) |
| ğŸ  é¨’éŸ³ | é¨’éŸ³ãƒ¬ãƒ™ãƒ«æ¨ç§» | Netatmo (NAMain) |
| ğŸŒ¬ï¸ é¢¨é€Ÿ | é¢¨é€Ÿæ¨ç§» | Netatmo (NAModule2) |
| ğŸŒ¬ï¸ çªé¢¨ | çªé¢¨é€Ÿåº¦æ¨ç§» | Netatmo (NAModule2) |
| ğŸŒ§ï¸ é›¨é‡ | ç¾åœ¨ã®é›¨é‡ | Netatmo (NAModule3) |
| ğŸŒ§ï¸ é›¨é‡ (24h) | 24æ™‚é–“ç´¯è¨ˆé›¨é‡ | Netatmo (NAModule3) |

**æ³¨**: ã‚»ãƒ³ã‚µãƒ¼ãŒãªã„å ´åˆã€ãã®ã‚°ãƒ©ãƒ•ã¯ç”Ÿæˆã•ã‚Œã¾ã›ã‚“ã€‚

### ãƒ‡ãƒã‚¤ã‚¹åã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹

ã‚°ãƒ©ãƒ•ã§ã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®ã‚½ãƒ¼ã‚¹ãŒã‚ã‹ã‚‹ã‚ˆã†ã«ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒä»˜ãã¾ã™ï¼š

| ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ | ã‚½ãƒ¼ã‚¹ |
|--------------|--------|
| `[SB]` | SwitchBot |
| `[NA]` | Netatmo |

### å±‹å¤–ã‚»ãƒ³ã‚µãƒ¼ã®åˆ¤å®š

**SwitchBot:** ãƒ‡ãƒã‚¤ã‚¹åã«ä»¥ä¸‹ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã‚‹å ´åˆã€å±‹å¤–ã‚»ãƒ³ã‚µãƒ¼ã¨ã—ã¦æ‰±ã„ã¾ã™ï¼š
- `é˜²æ°´æ¸©æ¹¿åº¦è¨ˆ`
- `å±‹å¤–`
- `Outdoor`

**Netatmo:** ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ—ãŒ `NAModule1`ï¼ˆå±‹å¤–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ã®å ´åˆã€è‡ªå‹•çš„ã«å±‹å¤–ã¨ã—ã¦åˆ¤å®šã•ã‚Œã¾ã™ã€‚

### Netatmoå›ºæœ‰ã®è¨ˆæ¸¬å€¤

Netatmoã‚»ãƒ³ã‚µãƒ¼ã¯ã‚µãƒãƒªãƒ¼ã§ä»¥ä¸‹ã®è¿½åŠ æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ï¼š

| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | è¨ˆæ¸¬å€¤ |
|-----------|--------|
| NAMainï¼ˆãƒ¡ã‚¤ãƒ³ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ | æ°—åœ§ï¼ˆhPaï¼‰ã€é¨’éŸ³ï¼ˆdBï¼‰ |
| NAModule2ï¼ˆé¢¨ã‚»ãƒ³ã‚µãƒ¼ï¼‰ | é¢¨é€Ÿï¼ˆkm/hï¼‰ã€çªé¢¨ï¼ˆkm/hï¼‰ |
| NAModule3ï¼ˆé›¨ã‚»ãƒ³ã‚µãƒ¼ï¼‰ | é›¨é‡ï¼ˆmmï¼‰ã€24hç´¯è¨ˆï¼ˆmmï¼‰ |

### ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³

ã‚°ãƒ©ãƒ•ã®æ¨ªè»¸ã¯ **JSTï¼ˆæ—¥æœ¬æ¨™æº–æ™‚ï¼‰** ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

## ãŠå¤–ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆNetatmoå°‚ç”¨ï¼‰

Netatmoã‚»ãƒ³ã‚µãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ã€å¤©æ°—ãƒ»ä½“èª¿ã«é–¢ã™ã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ `#outdoor-alert` ãƒãƒ£ãƒ³ãƒãƒ«ã«é€ä¿¡ã—ã¾ã™ã€‚

### ã‚¢ãƒ©ãƒ¼ãƒˆã®ç¨®é¡

| ã‚¢ãƒ©ãƒ¼ãƒˆ | æ¡ä»¶ | ãƒ¬ãƒ™ãƒ« | æ ¹æ‹  |
|---------|------|--------|------|
| â˜” **é›¨ãŒé™ã‚Šå§‹ã‚ã¾ã—ãŸ** | é›¨é‡ 0â†’0è¶… | INFO | é›¨ã‚»ãƒ³ã‚µãƒ¼æ¤œçŸ¥ |
| ğŸŒ¬ï¸ **ã‚„ã‚„å¼·ã„é¢¨** | 36km/h (10m/s)ä»¥ä¸Š | INFO | [æ°—è±¡åº](https://www.jma.go.jp/jma/kishou/know/yougo_hp/kazehyo.pdf) - å‚˜ãŒã•ã›ãªã„ |
| ğŸŒ¬ï¸ **å¼·ã„é¢¨** | 54km/h (15m/s)ä»¥ä¸Š | WARNING | æ°—è±¡åº - é¢¨ã«å‘ã‹ã£ã¦æ­©ã‘ãªã„ |
| ğŸŒ¬ï¸ **éå¸¸ã«å¼·ã„é¢¨ï¼ˆæš´é¢¨ï¼‰** | 72km/h (20m/s)ä»¥ä¸Š | DANGER | æ°—è±¡åº - ç«‹ã£ã¦ã„ã‚‰ã‚Œãªã„ |
| ğŸŒ¡ï¸ **æ˜¨æ—¥ã‚ˆã‚Šæš‘ã„/å¯’ã„** | å‰æ—¥åŒæ™‚åˆ»æ¯”Â±2â„ƒä»¥ä¸Š | INFO/WARNING(Â±5â„ƒ) | ä½“æ„Ÿå¤‰åŒ– |
| ğŸ“‰ **æ°—åœ§ä½ä¸‹/ä¸Šæ˜‡å‚¾å‘** | 6æ™‚é–“ã§4hPaä»¥ä¸Šå¤‰åŒ– | INFO | [ç ”ç©¶](https://zutool.jp/column/lifestyle/post-26643) - è‡ªå¾‹ç¥çµŒå½±éŸ¿ |
| ğŸ“‰ **æ°—åœ§å¤‰åŒ–ï¼ˆé ­ç—›æ³¨æ„ï¼‰** | 6æ™‚é–“ã§6hPaä»¥ä¸Šå¤‰åŒ– | WARNING | ç ”ç©¶ - é ­ç—›ç™ºç—‡ã—ã‚„ã™ã„ |
| ğŸ“‰ **æ°—åœ§æ€¥å¤‰ï¼ˆæ°—è±¡ç—…è­¦æˆ’ï¼‰** | 6æ™‚é–“ã§10hPaä»¥ä¸Šå¤‰åŒ– | DANGER | æ°—è±¡åº - æ€¥é€Ÿç™ºé”ä½æ°—åœ§åŸºæº– |

### ã‚¢ãƒ©ãƒ¼ãƒˆã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³

åŒã˜ç¨®é¡ã®ã‚¢ãƒ©ãƒ¼ãƒˆã¯ã€åŒä¸€ãƒ‡ãƒã‚¤ã‚¹ã«å¯¾ã—ã¦**1æ™‚é–“ã«1å›**ã¾ã§ã—ã‹é€ä¿¡ã•ã‚Œã¾ã›ã‚“ï¼ˆã‚¹ãƒ‘ãƒ é˜²æ­¢ï¼‰ã€‚

### ã‚¢ãƒ©ãƒ¼ãƒˆåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã®è©³ç´°

#### é›¨ã‚¢ãƒ©ãƒ¼ãƒˆ
```
IF ç¾åœ¨ã®é›¨é‡ > 0 AND (å‰å›ã®é›¨é‡ == 0 OR å‰å›ã®é›¨é‡ == NULL)
THEN ã€Œé›¨ãŒé™ã‚Šå§‹ã‚ã¾ã—ãŸã€ã‚’é€šçŸ¥
```
- **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: NAModule3 ã® `Rain` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- **åˆ¤å®šã‚¿ã‚¤ãƒŸãƒ³ã‚°**: Netatmoãƒãƒ¼ãƒªãƒ³ã‚°æ™‚ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ10åˆ†é–“éš”ï¼‰

#### é¢¨ã‚¢ãƒ©ãƒ¼ãƒˆ
```
é¢¨é€Ÿ = MAX(wind_strength, gust_strength)

IF é¢¨é€Ÿ >= 72 km/h THEN DANGERã€Œéå¸¸ã«å¼·ã„é¢¨ï¼ˆæš´é¢¨ï¼‰ã€
ELSE IF é¢¨é€Ÿ >= 54 km/h THEN WARNINGã€Œå¼·ã„é¢¨ã€
ELSE IF é¢¨é€Ÿ >= 36 km/h THEN INFOã€Œã‚„ã‚„å¼·ã„é¢¨ã€
```
- **ã—ãã„å€¤æ ¹æ‹ **: [æ°—è±¡åº é¢¨ã®å¼·ã•ã¨å¹ãæ–¹](https://www.jma.go.jp/jma/kishou/know/yougo_hp/kazehyo.pdf)
- **å¤‰æ›**: 10m/s = 36km/h, 15m/s = 54km/h, 20m/s = 72km/h

#### æ°—æ¸©å¤‰åŒ–ã‚¢ãƒ©ãƒ¼ãƒˆ
```
å·®åˆ† = ç¾åœ¨ã®æ°—æ¸© - 24æ™‚é–“å‰ã®æ°—æ¸©

IF |å·®åˆ†| >= 5.0Â°C THEN WARNING
ELSE IF |å·®åˆ†| >= 2.0Â°C THEN INFO

ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:
  å·®åˆ† > 0 â†’ ã€Œæ˜¨æ—¥ã‚ˆã‚Šâ—‹Â°Cæš‘ã„ã§ã™ã€
  å·®åˆ† < 0 â†’ ã€Œæ˜¨æ—¥ã‚ˆã‚Šâ—‹Â°Cå¯’ã„ã§ã™ã€
```
- **æ¯”è¼ƒå¯¾è±¡**: åŒã˜å±‹å¤–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆNAModule1ï¼‰ã®24æ™‚é–“å‰ã®ãƒ‡ãƒ¼ã‚¿
- **è¨±å®¹èª¤å·®**: Â±30åˆ†ä»¥å†…ã®æœ€ã‚‚è¿‘ã„ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ç”¨

#### æ°—åœ§å¤‰åŒ–ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆé ­ç—›ãƒ¼ã‚‹é¢¨ï¼‰
```
å·®åˆ† = ç¾åœ¨ã®æ°—åœ§ - 6æ™‚é–“å‰ã®æ°—åœ§

IF |å·®åˆ†| >= 10 hPa THEN DANGERã€Œæ°—åœ§æ€¥æ¿€å¤‰åŒ–ï¼ˆæ°—è±¡ç—…è­¦æˆ’ï¼‰ã€
ELSE IF |å·®åˆ†| >= 6 hPa THEN WARNINGã€Œé ­ç—›ã«æ³¨æ„ã€
ELSE IF |å·®åˆ†| >= 4 hPa THEN INFOã€Œæ°—åœ§å‚¾å‘ã€

è¿½åŠ æ¡ä»¶:
  IF ç¾åœ¨ã®æ°—åœ§ < 1000 hPa THEN ã€Œä½æ°—åœ§ã€ã‚’ä»˜è¨˜
```
- **ã—ãã„å€¤æ ¹æ‹ **:
  - 4hPa/6h: [ç ”ç©¶](https://zutool.jp/column/lifestyle/post-26643) - è‡ªå¾‹ç¥çµŒã¸ã®å½±éŸ¿ãŒå‡ºå§‹ã‚ã‚‹
  - 6hPa/6h: ç ”ç©¶ - æ¨™æº–æ°—åœ§1013hPaã‹ã‚‰6ã€œ10hPaä½ä¸‹ã§é ­ç—›ç™ºç—‡ç‡ãŒæœ€ã‚‚é«˜ã„
  - 10hPa/6h: æ°—è±¡åºã®ã€Œæ€¥é€Ÿã«ç™ºé”ã™ã‚‹ä½æ°—åœ§ã€åŸºæº–ï¼ˆ12æ™‚é–“ã§10hPaä»¥ä¸Šï¼‰

### å¿…è¦ãªNetatmoãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

| ã‚¢ãƒ©ãƒ¼ãƒˆ | å¿…è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |
|---------|--------------|
| é›¨ | NAModule3ï¼ˆé›¨ã‚»ãƒ³ã‚µãƒ¼ï¼‰ |
| é¢¨ | NAModule2ï¼ˆé¢¨ã‚»ãƒ³ã‚µãƒ¼ï¼‰ |
| æ°—æ¸©å¤‰åŒ– | NAModule1ï¼ˆå±‹å¤–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ |
| æ°—åœ§å¤‰åŒ– | NAMainï¼ˆãƒ¡ã‚¤ãƒ³ã‚¹ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ |

## é˜²çŠ¯é€šçŸ¥ï¼ˆæ—¥æœ¬èªï¼‰

`#home-security` ãƒãƒ£ãƒ³ãƒãƒ«ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ—¥æœ¬èªé€šçŸ¥ãŒé€ä¿¡ã•ã‚Œã¾ã™ï¼š

### SwitchBot

| ãƒ‡ãƒã‚¤ã‚¹ | é€šçŸ¥ä¾‹ |
|---------|--------|
| ã‚¹ãƒãƒ¼ãƒˆãƒ­ãƒƒã‚¯ | ğŸ”“ ãƒ­ãƒƒã‚¯Pro 24ãŒè§£éŒ ã•ã‚Œã¾ã—ãŸ / ğŸ”’ æ–½éŒ ã•ã‚Œã¾ã—ãŸ |
| é–‹é–‰ã‚»ãƒ³ã‚µãƒ¼ | ğŸšª é–‹é–‰ã‚»ãƒ³ã‚µãƒ¼3ãŒé–‹ãã¾ã—ãŸ / é–‰ã¾ã‚Šã¾ã—ãŸ |
| ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ãƒ³ã‚µãƒ¼ | ğŸ‘ å‹•ãã‚’æ¤œçŸ¥ã—ã¾ã—ãŸ |
| ãƒ‰ã‚¢ãƒ™ãƒ« | ğŸ”” ãƒ†ãƒ¬ãƒ“ãƒ‰ã‚¢ãƒ›ãƒ³ 30ãŒæŠ¼ã•ã‚Œã¾ã—ãŸ |

### Google Nest

| ã‚¤ãƒ™ãƒ³ãƒˆ | é€šçŸ¥ä¾‹ |
|---------|--------|
| ãƒ‰ã‚¢ãƒ™ãƒ«ãƒãƒ£ã‚¤ãƒ  | ğŸ”” ç„é–¢ãŒæŠ¼ã•ã‚Œã¾ã—ãŸ |
| äººç‰©æ¤œçŸ¥ | ğŸš¶ ç„é–¢ã§äººç‰©ã‚’æ¤œçŸ¥ã—ã¾ã—ãŸ |
| å‹•ä½“æ¤œçŸ¥ | ğŸ‘ ç„é–¢ã§å‹•ãã‚’æ¤œçŸ¥ã—ã¾ã—ãŸ |
| éŸ³å£°æ¤œçŸ¥ | ğŸ”Š ãƒªãƒ“ãƒ³ã‚°ã§éŸ³å£°ã‚’æ¤œçŸ¥ã—ã¾ã—ãŸ |

**ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ·»ä»˜:**

Nest Awareå¥‘ç´„æ™‚ã€ã‚¤ãƒ™ãƒ³ãƒˆé€šçŸ¥ã«ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‹•ç”»ï¼ˆMP4ï¼‰ãŒæ·»ä»˜ã•ã‚Œã¾ã™ã€‚

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
flowchart TB
    subgraph main["main.py (Monitor)"]
        direction TB

        subgraph input["ãƒ‡ãƒ¼ã‚¿åé›†"]
            sbPolling["SwitchBot Polling<br/>30åˆ†é–“éš”"]
            naPolling["Netatmo Polling<br/>10åˆ†é–“éš”"]
            nestPolling["Nest Polling<br/>5åˆ†é–“éš”"]
            nestPubsub["Nest Pub/Sub<br/>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ "]
            webhook["Webhook Server<br/>port 8080<br/>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å—ä¿¡"]
        end

        cf["Cloudflare<br/>Quick Tunnel"] --> webhook

        sbPolling --> db
        naPolling --> db
        nestPolling --> db
        nestPubsub --> security
        webhook --> db

        db["database.py (SQLite)<br/>çŠ¶æ…‹ä¿å­˜ / å¤‰æ›´æ¤œå‡º<br/>SwitchBotæ™‚ç³»åˆ— / Netatmoæ™‚ç³»åˆ—"]

        db --> security["#home-security<br/>é˜²çŠ¯é€šçŸ¥ï¼ˆæ—¥æœ¬èªï¼‰"]
        db --> atmos["#atmos-update<br/>ç’°å¢ƒå¤‰åŒ–é€šçŸ¥"]
        db --> atmosGraph["#atmos-graph<br/>5åˆ†ã”ã¨ã‚°ãƒ©ãƒ•"]
        db --> dashboard["Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰<br/>port 7777<br/>30ç§’è‡ªå‹•æ›´æ–°"]
    end

    subgraph external["å¤–éƒ¨API"]
        sbAPI["SwitchBot API<br/>v1.1"]
        naAPI["Netatmo API<br/>OAuth2"]
        nestAPI["Google Nest SDM API<br/>OAuth2"]
        pubsub["Cloud Pub/Sub"]
    end

    sbAPI --> sbPolling
    naAPI --> naPolling
    nestAPI --> nestPolling
    pubsub --> nestPubsub
```

## Supervisorã§ã‚µãƒ¼ãƒ“ã‚¹åŒ–

`/etc/supervisor/conf.d/switchbot-monitor.conf`:

```ini
[program:switchbot-monitor]
command=/usr/bin/python3 /home/pi/switchbot-hub/main.py
directory=/home/pi/switchbot-hub
user=pi
autostart=true
autorestart=true
stdout_logfile=/var/log/switchbot-monitor.log
stderr_logfile=/var/log/switchbot-monitor-error.log
```

```bash
sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl start switchbot-monitor
```

## APIåˆ¶é™ã«ã¤ã„ã¦

### SwitchBot
- **1æ—¥10,000ãƒªã‚¯ã‚¨ã‚¹ãƒˆ** ã®åˆ¶é™
- Webhookã¯ã‚µãƒ¼ãƒãƒ¼å´ã‹ã‚‰ã®Pushé€šçŸ¥ãªã®ã§APIåˆ¶é™ã«ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œãªã„
- ãƒãƒ¼ãƒªãƒ³ã‚°å¯¾è±¡ã‚’æ¸›ã‚‰ã›ã°APIä½¿ç”¨é‡ã‚’å¤§å¹…ã«å‰Šæ¸›å¯èƒ½

### Netatmo
- **APIãƒªã‚¯ã‚¨ã‚¹ãƒˆåˆ¶é™ã‚ã‚Š**ï¼ˆå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‚ç…§ï¼‰
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ10åˆ†é–“éš”ã§ã®ãƒãƒ¼ãƒªãƒ³ã‚°ã‚’æ¨å¥¨
- ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¯3æ™‚é–“ã§æœŸé™åˆ‡ã‚Œï¼ˆè‡ªå‹•æ›´æ–°ï¼‰

### Google Nest
- **Device Access API**: åˆ¶é™ã‚ã‚Šï¼ˆå…·ä½“çš„ãªæ•°å€¤ã¯éå…¬é–‹ï¼‰
- Pub/Subã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡æ¨å¥¨ï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ä¸è¦ï¼‰
- ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¯1æ™‚é–“ã§æœŸé™åˆ‡ã‚Œï¼ˆè‡ªå‹•æ›´æ–°ï¼‰
- ã‚¯ãƒªãƒƒãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«ã¯**Nest Awareå¥‘ç´„**ãŒå¿…è¦

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
switchbot-hub/
â”œâ”€â”€ main.py                 # ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ switchbot_api.py        # SwitchBot API v1.1ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ netatmo_api.py          # Netatmo Weather Station APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ netatmo_auth.py         # Netatmo OAuth2èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”œâ”€â”€ google_nest_api.py      # Google Nest SDM APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ google_nest_auth.py     # Google Nest OAuth2èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”œâ”€â”€ google_nest_pubsub.py   # Pub/Sub ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡
â”œâ”€â”€ database.py             # SQLiteçŠ¶æ…‹ç®¡ç†ãƒ»æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ slack_notifier.py       # Slacké€šçŸ¥ï¼ˆè¤‡æ•°ãƒãƒ£ãƒ³ãƒãƒ«å¯¾å¿œï¼‰
â”œâ”€â”€ garbage_notifier.py     # ã‚´ãƒŸåé›†ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥
â”œâ”€â”€ webhook_server.py       # HTTPã‚µãƒ¼ãƒãƒ¼ï¼ˆWebhookå—ä¿¡ï¼‰
â”œâ”€â”€ cloudflare_tunnel.py    # Cloudflare Tunnelç®¡ç†
â”œâ”€â”€ chart_generator.py      # QuickChart.ioã§ã‚°ãƒ©ãƒ•ç”Ÿæˆ
â”œâ”€â”€ local_chart_generator.py # matplotlibã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚°ãƒ©ãƒ•ç”Ÿæˆï¼ˆRaspberry Piå‘ã‘ï¼‰
â”œâ”€â”€ dashboard_server.py     # Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ HTTPã‚µãƒ¼ãƒãƒ¼
â”œâ”€â”€ garbage_images/         # ã‚´ãƒŸç¨®é¡ã”ã¨ã®ç”»åƒ
â”œâ”€â”€ config.json.example     # è¨­å®šã‚µãƒ³ãƒ—ãƒ«
â””â”€â”€ config.json             # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¦ä½œæˆï¼‰
```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
